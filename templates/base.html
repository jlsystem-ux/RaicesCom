{% load static i18n %}
<!DOCTYPE html>
<html lang="{% get_current_language as LANGUAGE_CODE %}{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SEO Meta Tags -->
    <title>{% block title %}{% trans 'Raíces Compartidas | Apoyo a Refugiados' %}{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}{% trans 'Raíces Compartidas brinda apoyo integral a refugiados y solicitantes de asilo en el Reino Unido. Recursos, eventos, apoyo emocional y integración cultural.' %}{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}{% trans 'refugiados, solicitantes asilo, Reino Unido, apoyo, integración cultural, recursos, NHS, bienestar emocional, comunidad' %}{% endblock %}">
    <meta name="author" content="Raíces Compartidas">
    <meta name="robots" content="{% block robots %}index, follow{% endblock %}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Canonical URL -->
    <link rel="canonical" href="{% block canonical_url %}https://lurba1984.pythonanywhere.com{% endblock %}">

    <!-- Language and Locale -->
    {% get_current_language as LANGUAGE_CODE %}
    <meta property="locale" content="{{ LANGUAGE_CODE }}">

    <!-- Hreflang for multilingual SEO -->
    <link rel="alternate" hreflang="en" href="https://lurba1984.pythonanywhere.com/en{{ request.path }}">
    <link rel="alternate" hreflang="es" href="https://lurba1984.pythonanywhere.com/es{{ request.path }}">
    <link rel="alternate" hreflang="x-default" href="https://lurba1984.pythonanywhere.com{{ request.path }}">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}{% trans 'Raíces Compartidas | Apoyo a Refugiados' %}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{% trans 'Raíces Compartidas brinda apoyo integral a refugiados y solicitantes de asilo en el Reino Unido. Recursos, eventos, apoyo emocional y integración cultural.' %}{% endblock %}">
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}https://lurba1984.pythonanywhere.com{% endblock %}">
    <meta property="og:image" content="{% block og_image %}https://lurba1984.pythonanywhere.com{% static 'img/logoGmini2.png' %}{% endblock %}">
    <meta property="og:image:alt" content="{% trans 'Logo de Raíces Compartidas' %}">
    <meta property="og:site_name" content="Raíces Compartidas">
    <meta property="og:locale" content="{{ LANGUAGE_CODE }}">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}{% trans 'Raíces Compartidas | Apoyo a Refugiados' %}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{% trans 'Raíces Compartidas brinda apoyo integral a refugiados y solicitantes de asilo en el Reino Unido. Recursos, eventos, apoyo emocional y integración cultural.' %}{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}https://lurba1984.pythonanywhere.com{% static 'img/logoGmini2.png' %}{% endblock %}">
    <meta name="twitter:image:alt" content="{% trans 'Logo de Raíces Compartidas' %}">

    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'img/apple-touch-icon.png' %}">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/calendario.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Structured Data (JSON-LD) -->
    {% block structured_data %}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Raíces Compartidas",
        "alternateName": "Shared Roots",
        "url": "https://lurba1984.pythonanywhere.com",
        "logo": "https://lurba1984.pythonanywhere.com{% static 'img/logoGmini2.png' %}",
        "description": "{% trans 'Raíces Compartidas brinda apoyo integral a refugiados y solicitantes de asilo en el Reino Unido. Recursos, eventos, apoyo emocional y integración cultural.' %}",
        "foundingDate": "2024",
        "foundingLocation": {
            "@type": "Country",
            "name": "United Kingdom"
        },
        "area": {
            "@type": "Country",
            "name": "United Kingdom"
        },
        "knowsAbout": [
            "{% trans 'Apoyo a refugiados' %}",
            "{% trans 'Integración cultural' %}",
            "{% trans 'Recursos para solicitantes de asilo' %}",
            "{% trans 'Bienestar emocional' %}",
            "{% trans 'Servicios NHS' %}",
            "{% trans 'Comunidad de apoyo' %}"
        ],
        "sameAs": [
            "#"
        ],
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "GB"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "availableLanguage": ["English", "Spanish"]
        },
        "audience": {
            "@type": "Audience",
            "audienceType": "{% trans 'Refugiados y solicitantes de asilo' %}"
        }
    }
    </script>

    <!-- Breadcrumb Schema (SEO Enhancement) -->
    {% block breadcrumb_schema %}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "{% trans 'Inicio' %}",
                "item": "https://lurba1984.pythonanywhere.com{% url 'core:home' %}"
            }
            {% block breadcrumb_items %}{% endblock %}
        ]
    }
    </script>
    {% endblock breadcrumb_schema %}
    {% endblock structured_data %}

    <style>
        /* Enhanced navigation bar design */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: #4A90E2;
            color: white;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .navbar .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            color: white;
        }

        .navbar .logo-img {
            height: 40px;
            width: auto;
        }

        .navbar .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .navbar .nav-links a {
            text-decoration: none;
            color: white;
            font-weight: 500;
            transition: color 0.3s;
        }

        .navbar .nav-links a:hover {
            color: #FFD700;
        }

        .navbar .nav-links a.active {
            border-bottom: 2px solid #f0a500;
        }

        .language-selector {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 1rem;
        }

        .language-selector select {
            padding: 0.3rem 0.7rem;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 1rem;
        }

        /* Footer styles */
        .footer {
            background-color: #4A90E2;
            color: white;
            padding: 2rem 0;
        }

        .footer h3 {
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .footer p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .footer a {
            color: white;
            text-decoration: none;
        }

        .footer a:hover {
            color: #FFD700;
        }

        .footer .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 2rem;
        }

        .footer .footer-section {
            flex: 1;
            min-width: 250px;
        }

        .footer .footer-bottom {
            margin-top: 2rem;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding-top: 1rem;
        }

        /* NHS Info Card styles */
        #nhs-info-card {
            display: none;
            position: fixed;
            bottom: 100px;
            right: 40px;
            background: #fff;
            color: #222;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            padding: 1.5rem;
            z-index: 2000;
            min-width: 260px;
            max-width: 350px;
        }

        #nhs-info-card strong {
            display: block;
            margin-bottom: 0.5rem;
        }

        #nhs-info-card ul {
            margin: 0.5rem 0 0 1rem;
            padding: 0;
        }

        #nhs-info-card button {
            margin-top: 1rem;
            padding: 0.3rem 1rem;
            border: none;
            background: #4A90E2;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
    {% csrf_token %}
</head>
<body>
    <nav class="navbar">
        <a href="{% url 'core:home' %}" class="logo">
            <img src="{% static 'img/logoGmini2.png' %}" alt="Logo" class="logo-img">
            <span class="logo-text">{% trans 'Raíces Compartidas' %}</span>
        </a>
        <button class="menu-toggle" aria-label="Toggle menu">
            <span class="hamburger"></span>
            <span class="hamburger"></span>
            <span class="hamburger"></span>
        </button>
        <div class="nav-links">
            <a href="{% url 'core:home' %}#sobre-nosotros" title="{% trans 'Conoce nuestra misión de apoyo a refugiados' %}">{% trans 'Sobre Nosotros' %}</a>
            <a href="{% url 'core:home' %}#recursos" title="{% trans 'Recursos de bienestar y apoyo para refugiados' %}">{% trans 'Recursos' %}</a>
            <a href="{% url 'core:events_list' %}" title="{% trans 'Eventos culturales y talleres para refugiados' %}">{% trans 'Eventos' %}</a>
            <a href="{% url 'core:blog_list' %}" title="{% trans 'Noticias e historias de la comunidad' %}">{% trans 'Blog' %}</a>
            <a href="{% url 'core:contact' %}" title="{% trans 'Contacta para apoyo personalizado a refugiados' %}">{% trans 'Contacto' %}</a>
        </div>
    </nav>

    {% if messages %}
        <div class="container mt-3">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    {% block content %}{% endblock %}
    
    <footer class="footer">
        {% block footer %}
        <div class="footer-content">
            <div class="footer-section">
                <h3>{% trans 'Raíces Compartidas' %}</h3>
                <p>{% trans 'Apoyando a la comunidad de solicitantes de asilo en el Reino Unido.' %}</p>
                <div class="language-selector">
                    <form action="{% url 'set_language' %}" method="post" style="display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin-top: 1rem;">
                        {% csrf_token %}
                        <label for="lang-select" style="font-weight: 500;">🌐</label>
                        <select id="lang-select" name="language" onchange="this.form.submit()" style="padding: 0.3rem 0.7rem; border-radius: 6px; border: 1px solid #ccc;">
                            {% get_current_language as LANGUAGE_CODE %}
                            {% get_available_languages as LANGUAGES %}
                            {% for lang in LANGUAGES %}
                                <option value="{{ lang.0 }}" {% if lang.0 == LANGUAGE_CODE %}selected{% endif %}>{{ lang.1 }}</option>
                            {% endfor %}
                        </select>
                        <input type="hidden" name="next" value="{{ request.path }}">
                    </form>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>{% trans 'Enlaces Rápidos' %}</h3>
                <nav aria-label="{% trans 'Enlaces de navegación rápida' %}">
                    <ul>
                        <li><a href="{% url 'core:home' %}#sobre-nosotros" title="{% trans 'Conoce nuestra misión de apoyo a refugiados' %}">{% trans 'Sobre Nosotros' %}</a></li>
                        <li><a href="{% url 'core:home' %}#recursos" title="{% trans 'Recursos de bienestar para refugiados' %}">{% trans 'Recursos' %}</a></li>
                        <li><a href="{% url 'core:events_list' %}" title="{% trans 'Eventos y talleres comunitarios' %}">{% trans 'Eventos' %}</a></li>
                        <li><a href="{% url 'core:blog_list' %}" title="{% trans 'Noticias e historias de la comunidad' %}">{% trans 'Blog' %}</a></li>
                        <li><a href="{% url 'core:contact' %}" title="{% trans 'Contacto para apoyo personalizado' %}">{% trans 'Contacto' %}</a></li>
                    </ul>
                </nav>
            </div>
            
            <div class="footer-section">
                <h3>{% trans 'Recursos de Emergencia' %}</h3>
                <ul>
                    <li><a href="#">{% trans 'Apoyo en Crisis' %}</a></li>
                    <li><a href="#" id="nhs-link">NHS</a></li>
                </ul>
                <!-- NHS Info Card (hidden by default) -->
                <div id="nhs-info-card">
                    <strong>NHS - National Health Service</strong><br>
                    <ul style="margin:0.5rem 0 0 1rem; padding:0;">
                        <li><b>Emergency:</b> 999</li>
                        <li><b>Non-Emergency:</b> 111</li>
                        <li><b>Website:</b> <a href="https://www.nhs.uk" target="_blank">www.nhs.uk</a></li>
                    </ul>
                    <button onclick="document.getElementById('nhs-info-card').style.display='none'" style="margin-top:1rem; padding:0.3rem 1rem; border:none; background:#4A90E2; color:#fff; border-radius:5px; cursor:pointer;">Cerrar</button>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2024 {% trans 'Raíces Compartidas. Todos los derechos reservados.' %}</p>
            <div class="footer-links">
                <a href="#">{% trans 'Política de Privacidad' %}</a>
                <a href="#">{% trans 'Términos de Uso' %}</a>
                <a href="#">{% trans 'Accesibilidad' %}</a>
            </div>
        </div>
        {% endblock footer %}
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Your custom JavaScript -->
    <script src="{% static 'js/app.js' %}"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize navigation visibility based on screen size
        var navLinks = document.querySelector('.nav-links');
        if (navLinks) {
            if (window.innerWidth <= 768) {
                navLinks.style.display = 'none';
            } else {
                navLinks.style.display = 'flex';
            }
        }

        // NHS link functionality
        var nhsLink = document.getElementById('nhs-link');
        var nhsCard = document.getElementById('nhs-info-card');
        if (nhsLink && nhsCard) {
            nhsLink.addEventListener('click', function(e) {
                e.preventDefault();
                nhsCard.style.display = (nhsCard.style.display === 'none' || nhsCard.style.display === '') ? 'block' : 'none';
            });
        }

        // Hamburger menu functionality
        var menuToggle = document.querySelector('.menu-toggle');
        var navLinks = document.querySelector('.nav-links');

        if (menuToggle && navLinks) {
            menuToggle.addEventListener('click', function() {
                menuToggle.classList.toggle('active');
                navLinks.classList.toggle('active');

                // Toggle visibility of navigation sections
                var isActive = navLinks.classList.contains('active');
                if (window.innerWidth <= 768) {
                    navLinks.style.display = isActive ? 'flex' : 'none';
                }
            });

            // Close menu when clicking on a link
            var navLinkItems = navLinks.querySelectorAll('a');
            navLinkItems.forEach(function(link) {
                link.addEventListener('click', function() {
                    menuToggle.classList.remove('active');
                    navLinks.classList.remove('active');
                    if (window.innerWidth <= 768) {
                        navLinks.style.display = 'none';
                    }
                });
            });

            // Close menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!menuToggle.contains(e.target) && !navLinks.contains(e.target)) {
                    menuToggle.classList.remove('active');
                    navLinks.classList.remove('active');
                    if (window.innerWidth <= 768) {
                        navLinks.style.display = 'none';
                    }
                }
            });

            // Close menu on window resize to prevent layout issues
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    menuToggle.classList.remove('active');
                    navLinks.classList.remove('active');
                    navLinks.style.display = 'flex'; // Show on desktop
                } else {
                    navLinks.style.display = 'none'; // Hide on mobile by default
                }
            });
        }
    });
    </script>
</body>
</html>